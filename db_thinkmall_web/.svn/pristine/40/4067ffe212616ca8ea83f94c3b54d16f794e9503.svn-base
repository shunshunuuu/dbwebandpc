/*
 * iScroll v4.2.5 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
define(function(require, exports, module) {
require("{platRoot}/plugins/iscroll/css/iscroll-custom.css");
(function(Y,W){var L=Math,O=W.createElement("div").style,N=(function(){var h="t,webkitT,MozT,msT,OT".split(","),g,e=0,f=h.length;for(;e<f;e++){g=h[e]+"ransform";if(g in O){return h[e].substr(0,h[e].length-1)}}return false})(),B=N?"-"+N.toLowerCase()+"-":"",J=b("transform"),I=b("transitionProperty"),a=b("transitionDuration"),S=b("transformOrigin"),T=b("transitionTimingFunction"),V=b("transitionDelay"),A=(/android/gi).test(navigator.appVersion),c=(/iphone|ipad/gi).test(navigator.appVersion),H=(/hp-tablet/gi).test(navigator.appVersion),M=b("perspective") in O,K="ontouchstart" in Y&&!H,X=N!==false,Z=b("transition") in O,F="onorientationchange" in Y?"orientationchange":"resize",d=K?"touchstart":"mousedown",E=K?"touchmove":"mousemove",D=K?"touchend":"mouseup",U=K?"touchcancel":"mouseup",R=(function(){if(N===false){return false}var e={"":"transitionend","webkit":"webkitTransitionEnd","Moz":"transitionend","O":"otransitionend","ms":"MSTransitionEnd"};return e[N]})(),C=(function(){return Y.requestAnimationFrame||Y.webkitRequestAnimationFrame||Y.mozRequestAnimationFrame||Y.oRequestAnimationFrame||Y.msRequestAnimationFrame||function(e){return setTimeout(e,1)}})(),P=(function(){return Y.cancelRequestAnimationFrame||Y.webkitCancelAnimationFrame||Y.webkitCancelRequestAnimationFrame||Y.mozCancelRequestAnimationFrame||Y.oCancelRequestAnimationFrame||Y.msCancelRequestAnimationFrame||clearTimeout})(),Q=M?" translateZ(0)":"",G=function(e,h){var g=this,f;g.wrapper=typeof e=="object"?e:W.getElementById(e);g.wrapper.style.overflow="hidden";g.scroller=g.wrapper.children[0];g.options={hScroll:true,vScroll:true,x:0,y:0,bounce:true,bounceLock:false,momentum:true,lockDirection:true,useTransform:true,useTransition:false,topOffset:0,checkDOMChanges:false,handleClick:true,hScrollbar:true,vScrollbar:true,fixedScrollbar:A,hideScrollbar:c,fadeScrollbar:c&&M,scrollbarClass:"",zoom:false,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:false,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(i){i.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(f in h){g.options[f]=h[f]}g.x=g.options.x;g.y=g.options.y;g.options.useTransform=X&&g.options.useTransform;g.options.hScrollbar=g.options.hScroll&&g.options.hScrollbar;g.options.vScrollbar=g.options.vScroll&&g.options.vScrollbar;g.options.zoom=g.options.useTransform&&g.options.zoom;g.options.useTransition=Z&&g.options.useTransition;if(g.options.zoom&&A){Q=""}g.scroller.style[I]=g.options.useTransform?B+"transform":"top left";g.scroller.style[a]="0";g.scroller.style[S]="0 0";if(g.options.useTransition){g.scroller.style[T]="cubic-bezier(0.33,0.66,0.66,1)"}if(g.options.useTransform){g.scroller.style[J]="translate("+g.x+"px,"+g.y+"px)"+Q}else{g.scroller.style.cssText+=";position:absolute;top:"+g.y+"px;left:"+g.x+"px"}if(g.options.useTransition){g.options.fixedScrollbar=true}g.refresh();g._bind(F,Y);g._bind(d);if(!K){if(g.options.wheelAction!="none"){g._bind("DOMMouseScroll");g._bind("mousewheel")}}if(g.options.checkDOMChanges){g.checkDOMTime=setInterval(function(){g._checkDOMChanges()},500)}};G.prototype={enabled:true,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(f){var g=this;switch(f.type){case d:if(!K&&f.button!==0){return}g._start(f);break;case E:g._move(f);break;case D:case U:g._end(f);break;case F:g._resize();break;case"DOMMouseScroll":case"mousewheel":g._wheel(f);break;case R:g._transitionEnd(f);break}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||(this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)){return}this.refresh()},_scrollbar:function(e){var f=this,g;if(!f[e+"Scrollbar"]){if(f[e+"ScrollbarWrapper"]){if(X){f[e+"ScrollbarIndicator"].style[J]=""}f[e+"ScrollbarWrapper"].parentNode.removeChild(f[e+"ScrollbarWrapper"]);f[e+"ScrollbarWrapper"]=null;f[e+"ScrollbarIndicator"]=null}return}if(!f[e+"ScrollbarWrapper"]){g=W.createElement("div");if(f.options.scrollbarClass){g.className=f.options.scrollbarClass+e.toUpperCase()}else{g.style.cssText="position:absolute;z-index:100;"+(e=="h"?"height:7px;bottom:1px;left:2px;right:"+(f.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(f.hScrollbar?"7":"2")+"px;top:2px;right:1px")}g.style.cssText+=";pointer-events:none;"+B+"transition-property:opacity;"+B+"transition-duration:"+(f.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(f.options.hideScrollbar?"0":"1");f.wrapper.appendChild(g);f[e+"ScrollbarWrapper"]=g;g=W.createElement("div");if(!f.options.scrollbarClass){g.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+B+"background-clip:padding-box;"+B+"box-sizing:border-box;"+(e=="h"?"height:100%":"width:100%")+";"+B+"border-radius:3px;border-radius:3px"}g.style.cssText+=";pointer-events:none;"+B+"transition-property:"+B+"transform;"+B+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+B+"transition-duration:0;"+B+"transform: translate(0,0)"+Q;if(f.options.useTransition){g.style.cssText+=";"+B+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"}f[e+"ScrollbarWrapper"].appendChild(g);f[e+"ScrollbarIndicator"]=g}if(e=="h"){f.hScrollbarSize=f.hScrollbarWrapper.clientWidth;f.hScrollbarIndicatorSize=L.max(L.round(f.hScrollbarSize*f.hScrollbarSize/f.scrollerW),8);f.hScrollbarIndicator.style.width=f.hScrollbarIndicatorSize+"px";f.hScrollbarMaxScroll=f.hScrollbarSize-f.hScrollbarIndicatorSize;f.hScrollbarProp=f.hScrollbarMaxScroll/f.maxScrollX}else{f.vScrollbarSize=f.vScrollbarWrapper.clientHeight;f.vScrollbarIndicatorSize=L.max(L.round(f.vScrollbarSize*f.vScrollbarSize/f.scrollerH),8);f.vScrollbarIndicator.style.height=f.vScrollbarIndicatorSize+"px";f.vScrollbarMaxScroll=f.vScrollbarSize-f.vScrollbarIndicatorSize;f.vScrollbarProp=f.vScrollbarMaxScroll/f.maxScrollY}f._scrollbarPos(e,true)},_resize:function(){
//	var e=this;setTimeout(function(){e.refresh()},A?200:0) //以下代码替换
	var that = this;
	setTimeout(function () {
		/**
		 * 防止在wrapper不可见时，触发iscroll的resize事件的BUG
		 * wrapper元素添加一个自定义属性data-iscrollPageId，指定控制该wrapper的可见性的页面pageId
		 * 要是一个page中有多个wrapper做切换显示隐藏，需要还指定data-iscrollParentId，指定切换控制它的父元素id
		 */
		var pageDiv = document.getElementById(that.wrapper.getAttribute("data-iscrollPageId")),
			parentDiv = document.getElementById(that.wrapper.getAttribute("data-iscrollParentId")),
			ifDisplayPage = pageDiv?pageDiv.style.display:"",
			ifDisplayParent = parentDiv?parentDiv.style.display:"";
		if(ifDisplayPage != "none" && ifDisplayParent != "none")
			that.refresh();
	}, A ? 200 : 0);
},_pos:function(e,f){if(this.zoomed){return}e=this.hScroll?e:0;f=this.vScroll?f:0;if(this.options.useTransform){this.scroller.style[J]="translate("+e+"px,"+f+"px) scale("+this.scale+")"+Q}else{e=L.round(e);f=L.round(f);this.scroller.style.left=e+"px";this.scroller.style.top=f+"px"}this.x=e;this.y=f;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(e,i){var f=this,g=e=="h"?f.x:f.y,h;if(!f[e+"Scrollbar"]){return}g=f[e+"ScrollbarProp"]*g;if(g<0){if(!f.options.fixedScrollbar){h=f[e+"ScrollbarIndicatorSize"]+L.round(g*3);if(h<8){h=8}f[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=h+"px"}g=0}else{if(g>f[e+"ScrollbarMaxScroll"]){if(!f.options.fixedScrollbar){h=f[e+"ScrollbarIndicatorSize"]-L.round((g-f[e+"ScrollbarMaxScroll"])*3);if(h<8){h=8}f[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=h+"px";g=f[e+"ScrollbarMaxScroll"]+(f[e+"ScrollbarIndicatorSize"]-h)}else{g=f[e+"ScrollbarMaxScroll"]}}}f[e+"ScrollbarWrapper"].style[V]="0";f[e+"ScrollbarWrapper"].style.opacity=i&&f.options.hideScrollbar?"0":"1";f[e+"ScrollbarIndicator"].style[J]="translate("+(e=="h"?g+"px,0)":"0,"+g+"px)")+Q},_start:function(f){var j=this,m=K?f.touches[0]:f,i,k,l,g,h;if(!j.enabled){return}if(j.options.onBeforeScrollStart){j.options.onBeforeScrollStart.call(j,f)}if(j.options.useTransition||j.options.zoom){j._transitionTime(0)}j.moved=false;j.animating=false;j.zoomed=false;j.distX=0;j.distY=0;j.absDistX=0;j.absDistY=0;j.dirX=0;j.dirY=0;if(j.options.zoom&&K&&f.touches.length>1){g=L.abs(f.touches[0].pageX-f.touches[1].pageX);h=L.abs(f.touches[0].pageY-f.touches[1].pageY);j.touchesDistStart=L.sqrt(g*g+h*h);j.originX=L.abs(f.touches[0].pageX+f.touches[1].pageX-j.wrapperOffsetLeft*2)/2-j.x;j.originY=L.abs(f.touches[0].pageY+f.touches[1].pageY-j.wrapperOffsetTop*2)/2-j.y;if(j.options.onZoomStart){j.options.onZoomStart.call(j,f)}}if(j.options.momentum){if(j.options.useTransform){i=getComputedStyle(j.scroller,null)[J].replace(/[^0-9\-.,]/g,"").split(",");k=+(i[12]||i[4]);l=+(i[13]||i[5])}else{k=+getComputedStyle(j.scroller,null).left.replace(/[^0-9-]/g,"");l=+getComputedStyle(j.scroller,null).top.replace(/[^0-9-]/g,"")}if(k!=j.x||l!=j.y){if(j.options.useTransition){j._unbind(R)}else{P(j.aniTime)}j.steps=[];j._pos(k,l);if(j.options.onScrollEnd){j.options.onScrollEnd.call(j)}}}j.absStartX=j.x;j.absStartY=j.y;j.startX=j.x;j.startY=j.y;j.pointX=m.pageX;j.pointY=m.pageY;j.startTime=f.timeStamp||Date.now();if(j.options.onScrollStart){j.options.onScrollStart.call(j,f)}j._bind(E,Y);j._bind(D,Y);j._bind(U,Y)},_move:function(f){var k=this,j=K?f.touches[0]:f,o=j.pageX-k.pointX,g=j.pageY-k.pointY,p=k.x+o,m=k.y+g,h,l,i,n=f.timeStamp||Date.now();if(k.options.onBeforeScrollMove){k.options.onBeforeScrollMove.call(k,f)}if(k.options.zoom&&K&&f.touches.length>1){h=L.abs(f.touches[0].pageX-f.touches[1].pageX);l=L.abs(f.touches[0].pageY-f.touches[1].pageY);k.touchesDist=L.sqrt(h*h+l*l);k.zoomed=true;i=1/k.touchesDistStart*k.touchesDist*this.scale;if(i<k.options.zoomMin){i=0.5*k.options.zoomMin*Math.pow(2,i/k.options.zoomMin)}else{if(i>k.options.zoomMax){i=2*k.options.zoomMax*Math.pow(0.5,k.options.zoomMax/i)}}k.lastScale=i/this.scale;p=this.originX-this.originX*k.lastScale+this.x;m=this.originY-this.originY*k.lastScale+this.y;this.scroller.style[J]="translate("+p+"px,"+m+"px) scale("+i+")"+Q;if(k.options.onZoom){k.options.onZoom.call(k,f)}return}k.pointX=j.pageX;k.pointY=j.pageY;if(p>0||p<k.maxScrollX){p=k.options.bounce?k.x+(o/2):p>=0||k.maxScrollX>=0?0:k.maxScrollX}if(m>k.minScrollY||m<k.maxScrollY){m=k.options.bounce?k.y+(g/2):m>=k.minScrollY||k.maxScrollY>=0?k.minScrollY:k.maxScrollY}k.distX+=o;k.distY+=g;k.absDistX=L.abs(k.distX);k.absDistY=L.abs(k.distY);if(k.absDistX<6&&k.absDistY<6){return}if(k.options.lockDirection){if(k.absDistX>k.absDistY+5){m=k.y;g=0}else{if(k.absDistY>k.absDistX+5){p=k.x;o=0}}}k.moved=true;k._pos(p,m);k.dirX=o>0?-1:o<0?1:0;k.dirY=g>0?-1:g<0?1:0;if(n-k.startTime>300){k.startTime=n;k.startX=k.x;k.startY=k.y}if(k.options.onScrollMove){k.options.onScrollMove.call(k,f)}},_end:function(i){if(K&&i.touches.length!==0){return}var m=this,r=K?i.changedTouches[0]:i,p,j,f={dist:0,time:0},t={dist:0,time:0},l=(i.timeStamp||Date.now())-m.startTime,s=m.x,k=m.y,o,n,q,h,g;m._unbind(E,Y);m._unbind(D,Y);m._unbind(U,Y);if(m.options.onBeforeScrollEnd){m.options.onBeforeScrollEnd.call(m,i)}if(m.zoomed){g=m.scale*m.lastScale;g=Math.max(m.options.zoomMin,g);g=Math.min(m.options.zoomMax,g);m.lastScale=g/m.scale;m.scale=g;m.x=m.originX-m.originX*m.lastScale+m.x;m.y=m.originY-m.originY*m.lastScale+m.y;m.scroller.style[a]="200ms";m.scroller.style[J]="translate("+m.x+"px,"+m.y+"px) scale("+m.scale+")"+Q;m.zoomed=false;m.refresh();if(m.options.onZoomEnd){m.options.onZoomEnd.call(m,i)}return}if(!m.moved){if(K){if(m.doubleTapTimer&&m.options.zoom){clearTimeout(m.doubleTapTimer);m.doubleTapTimer=null;if(m.options.onZoomStart){m.options.onZoomStart.call(m,i)}m.zoom(m.pointX,m.pointY,m.scale==1?m.options.doubleTapZoom:1);if(m.options.onZoomEnd){setTimeout(function(){m.options.onZoomEnd.call(m,i)},200)}}else{if(this.options.handleClick){m.doubleTapTimer=setTimeout(function(){m.doubleTapTimer=null;p=r.target;while(p.nodeType!=1){p=p.parentNode}if(p.tagName!="SELECT"&&p.tagName!="INPUT"&&p.tagName!="TEXTAREA"){j=W.createEvent("MouseEvents");j.initMouseEvent("click",true,true,i.view,1,r.screenX,r.screenY,r.clientX,r.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,0,null);j._fake=true;p.dispatchEvent(j)}},m.options.zoom?250:0)}}}m._resetPos(400);if(m.options.onTouchEnd){m.options.onTouchEnd.call(m,i)}return}if(l<300&&m.options.momentum){f=s?m._momentum(s-m.startX,l,-m.x,m.scrollerW-m.wrapperW+m.x,m.options.bounce?m.wrapperW:0):f;t=k?m._momentum(k-m.startY,l,-m.y,(m.maxScrollY<0?m.scrollerH-m.wrapperH+m.y-m.minScrollY:0),m.options.bounce?m.wrapperH:0):t;s=m.x+f.dist;k=m.y+t.dist;if((m.x>0&&s>0)||(m.x<m.maxScrollX&&s<m.maxScrollX)){f={dist:0,time:0}}if((m.y>m.minScrollY&&k>m.minScrollY)||(m.y<m.maxScrollY&&k<m.maxScrollY)){t={dist:0,time:0}}}if(f.dist||t.dist){q=L.max(L.max(f.time,t.time),10);if(m.options.snap){o=s-m.absStartX;n=k-m.absStartY;if(L.abs(o)<m.options.snapThreshold&&L.abs(n)<m.options.snapThreshold){m.scrollTo(m.absStartX,m.absStartY,200)}else{h=m._snap(s,k);s=h.x;k=h.y;q=L.max(h.time,q)}}m.scrollTo(L.round(s),L.round(k),q);if(m.options.onTouchEnd){m.options.onTouchEnd.call(m,i)}return}if(m.options.snap){o=s-m.absStartX;n=k-m.absStartY;if(L.abs(o)<m.options.snapThreshold&&L.abs(n)<m.options.snapThreshold){m.scrollTo(m.absStartX,m.absStartY,200)}else{h=m._snap(m.x,m.y);if(h.x!=m.x||h.y!=m.y){m.scrollTo(h.x,h.y,h.time)}}if(m.options.onTouchEnd){m.options.onTouchEnd.call(m,i)}return}m._resetPos(200);if(m.options.onTouchEnd){m.options.onTouchEnd.call(m,i)}},_resetPos:function(g){var f=this,h=f.x>=0?0:f.x<f.maxScrollX?f.maxScrollX:f.x,e=f.y>=f.minScrollY||f.maxScrollY>0?f.minScrollY:f.y<f.maxScrollY?f.maxScrollY:f.y;if(h==f.x&&e==f.y){if(f.moved){f.moved=false;if(f.options.onScrollEnd){f.options.onScrollEnd.call(f)}}if(f.hScrollbar&&f.options.hideScrollbar){if(N=="webkit"){f.hScrollbarWrapper.style[V]="300ms"}f.hScrollbarWrapper.style.opacity="0"}if(f.vScrollbar&&f.options.hideScrollbar){if(N=="webkit"){f.vScrollbarWrapper.style[V]="300ms"}f.vScrollbarWrapper.style.opacity="0"}return}f.scrollTo(h,e,g||0)},_wheel:function(g){var h=this,l,f,k,j,i;if("wheelDeltaX" in g){l=g.wheelDeltaX/12;f=g.wheelDeltaY/12}else{if("wheelDelta" in g){l=f=g.wheelDelta/12}else{if("detail" in g){l=f=-g.detail*3}else{return}}}if(h.options.wheelAction=="zoom"){i=h.scale*Math.pow(2,1/3*(f?f/Math.abs(f):0));if(i<h.options.zoomMin){i=h.options.zoomMin}if(i>h.options.zoomMax){i=h.options.zoomMax}if(i!=h.scale){if(!h.wheelZoomCount&&h.options.onZoomStart){h.options.onZoomStart.call(h,g)}h.wheelZoomCount++;h.zoom(g.pageX,g.pageY,i,400);setTimeout(function(){h.wheelZoomCount--;if(!h.wheelZoomCount&&h.options.onZoomEnd){h.options.onZoomEnd.call(h,g)}},400)}return}k=h.x+l;j=h.y+f;if(k>0){k=0}else{if(k<h.maxScrollX){k=h.maxScrollX}}if(j>h.minScrollY){j=h.minScrollY}else{if(j<h.maxScrollY){j=h.maxScrollY}}if(h.maxScrollY<0){h.scrollTo(k,j,0)}},_transitionEnd:function(f){var g=this;if(f.target!=g.scroller){return}g._unbind(R);g._startAni()},_startAni:function(){var g=this,f=g.x,j=g.y,i=Date.now(),e,k,h;if(g.animating){return}if(!g.steps.length){g._resetPos(400);return}e=g.steps.shift();if(e.x==f&&e.y==j){e.time=0}g.animating=true;g.moved=true;if(g.options.useTransition){g._transitionTime(e.time);g._pos(e.x,e.y);g.animating=false;if(e.time){g._bind(R)}else{g._resetPos(0)}return}h=function(){var n=Date.now(),l,m;if(n>=i+e.time){g._pos(e.x,e.y);g.animating=false;if(g.options.onAnimationEnd){g.options.onAnimationEnd.call(g)}g._startAni();return}n=(n-i)/e.time-1;k=L.sqrt(1-n*n);l=(e.x-f)*k+f;m=(e.y-j)*k+j;g._pos(l,m);if(g.animating){g.aniTime=C(h)}};h()},_transitionTime:function(e){e+="ms";this.scroller.style[a]=e;if(this.hScrollbar){this.hScrollbarIndicator.style[a]=e}if(this.vScrollbar){this.vScrollbarIndicator.style[a]=e}},_momentum:function(l,e,k,f,i){var n=0.0006,g=L.abs(l)/e,h=(g*g)/(2*n),j=0,m=0;if(l>0&&h>k){m=i/(6/(h/g*n));k=k+m;g=g*k/h;h=k}else{if(l<0&&h>f){m=i/(6/(h/g*n));f=f+m;g=g*f/h;h=f}}h=h*(l<0?-1:1);j=g/n;return{dist:h,time:L.round(j)}},_offset:function(e){var f=-e.offsetLeft,g=-e.offsetTop;while(e=e.offsetParent){f-=e.offsetLeft;g-=e.offsetTop}if(e!=this.wrapper){f*=this.scale;g*=this.scale}return{left:f,top:g}},_snap:function(n,o){var j=this,h,m,f,e,g,k;f=j.pagesX.length-1;for(h=0,m=j.pagesX.length;h<m;h++){if(n>=j.pagesX[h]){f=h;break}}if(f==j.currPageX&&f>0&&j.dirX<0){f--}n=j.pagesX[f];g=L.abs(n-j.pagesX[j.currPageX]);g=g?L.abs(j.x-n)/g*500:0;j.currPageX=f;f=j.pagesY.length-1;for(h=0;h<f;h++){if(o>=j.pagesY[h]){f=h;break}}if(f==j.currPageY&&f>0&&j.dirY<0){f--}o=j.pagesY[f];k=L.abs(o-j.pagesY[j.currPageY]);k=k?L.abs(j.y-o)/k*500:0;j.currPageY=f;e=L.round(L.max(g,k))||200;return{x:n,y:o,time:e}},_bind:function(e,f,g){(f||this.scroller).addEventListener(e,this,!!g)},_unbind:function(e,f,g){(f||this.scroller).removeEventListener(e,this,!!g)},destroy:function(){var e=this;e.scroller.style[J]="";e.hScrollbar=false;e.vScrollbar=false;e._scrollbar("h");e._scrollbar("v");e._unbind(F,Y);e._unbind(d);e._unbind(E,Y);e._unbind(D,Y);e._unbind(U,Y);if(!e.options.hasTouch){e._unbind("DOMMouseScroll");e._unbind("mousewheel")}if(e.options.useTransition){e._unbind(R)}if(e.options.checkDOMChanges){clearInterval(e.checkDOMTime)}if(e.options.onDestroy){e.options.onDestroy.call(e)}},refresh:function(){var g=this,e,f,h,j,m=0,k=0;if(g.scale<g.options.zoomMin){g.scale=g.options.zoomMin}g.wrapperW=g.wrapper.clientWidth||1;g.wrapperH=g.wrapper.clientHeight||1;g.minScrollY=-g.options.topOffset||0;g.scrollerW=L.round(g.scroller.offsetWidth*g.scale);g.scrollerH=L.round((g.scroller.offsetHeight+g.minScrollY)*g.scale);g.maxScrollX=g.wrapperW-g.scrollerW;g.maxScrollY=g.wrapperH-g.scrollerH+g.minScrollY;g.dirX=0;g.dirY=0;if(g.options.onRefresh){g.options.onRefresh.call(g)}g.hScroll=g.options.hScroll&&g.maxScrollX<0;g.vScroll=g.options.vScroll&&(!g.options.bounceLock&&!g.hScroll||g.scrollerH>g.wrapperH);g.hScrollbar=g.hScroll&&g.options.hScrollbar;g.vScrollbar=g.vScroll&&g.options.vScrollbar&&g.scrollerH>g.wrapperH;e=g._offset(g.wrapper);g.wrapperOffsetLeft=-e.left;g.wrapperOffsetTop=-e.top;if(typeof g.options.snap=="string"){g.pagesX=[];g.pagesY=[];j=g.scroller.querySelectorAll(g.options.snap);for(f=0,h=j.length;f<h;f++){m=g._offset(j[f]);m.left+=g.wrapperOffsetLeft;m.top+=g.wrapperOffsetTop;g.pagesX[f]=m.left<g.maxScrollX?g.maxScrollX:m.left*g.scale;g.pagesY[f]=m.top<g.maxScrollY?g.maxScrollY:m.top*g.scale}}else{if(g.options.snap){g.pagesX=[];while(m>=g.maxScrollX){g.pagesX[k]=m;m=m-g.wrapperW;k++}if(g.maxScrollX%g.wrapperW){g.pagesX[g.pagesX.length]=g.maxScrollX-g.pagesX[g.pagesX.length-1]+g.pagesX[g.pagesX.length-1]}m=0;k=0;g.pagesY=[];while(m>=g.maxScrollY){g.pagesY[k]=m;m=m-g.wrapperH;k++}if(g.maxScrollY%g.wrapperH){g.pagesY[g.pagesY.length]=g.maxScrollY-g.pagesY[g.pagesY.length-1]+g.pagesY[g.pagesY.length-1]}}}g._scrollbar("h");g._scrollbar("v");if(!g.zoomed){g.scroller.style[a]="0";g._resetPos(400)}},scrollTo:function(k,m,e,n){var h=this,f=k,g,j;h.stop();if(!f.length){f=[{x:k,y:m,time:e,relative:n}]}for(g=0,j=f.length;g<j;g++){if(f[g].relative){f[g].x=h.x-f[g].x;f[g].y=h.y-f[g].y}h.steps.push({x:f[g].x,y:f[g].y,time:f[g].time||0})}h._startAni()},scrollToElement:function(e,h){var f=this,g;e=e.nodeType?e:f.scroller.querySelector(e);if(!e){return}g=f._offset(e);g.left+=f.wrapperOffsetLeft;g.top+=f.wrapperOffsetTop;g.left=g.left>0?0:g.left<f.maxScrollX?f.maxScrollX:g.left;g.top=g.top>f.minScrollY?f.minScrollY:g.top<f.maxScrollY?f.maxScrollY:g.top;h=h===undefined?L.max(L.abs(g.left)*2,L.abs(g.top)*2):h;f.scrollTo(g.left,g.top,h)},scrollToPage:function(g,f,h){var e=this,i,j;h=h===undefined?400:h;if(e.options.onScrollStart){e.options.onScrollStart.call(e)}if(e.options.snap){g=g=="next"?e.currPageX+1:g=="prev"?e.currPageX-1:g;f=f=="next"?e.currPageY+1:f=="prev"?e.currPageY-1:f;g=g<0?0:g>e.pagesX.length-1?e.pagesX.length-1:g;f=f<0?0:f>e.pagesY.length-1?e.pagesY.length-1:f;e.currPageX=g;e.currPageY=f;i=e.pagesX[g];j=e.pagesY[f]}else{i=-e.wrapperW*g;j=-e.wrapperH*f;if(i<e.maxScrollX){i=e.maxScrollX}if(j<e.maxScrollY){j=e.maxScrollY}}e.scrollTo(i,j,h)},disable:function(){this.stop();this._resetPos(0);this.enabled=false;this._unbind(E,Y);this._unbind(D,Y);this._unbind(U,Y)},enable:function(){this.enabled=true},stop:function(){if(this.options.useTransition){this._unbind(R)}else{P(this.aniTime)}this.steps=[];this.moved=false;this.animating=false},zoom:function(g,h,i,j){var f=this,e=i/f.scale;if(!f.options.useTransform){return}f.zoomed=true;j=j===undefined?200:j;g=g-f.wrapperOffsetLeft-f.x;h=h-f.wrapperOffsetTop-f.y;f.x=g-g*e+f.x;f.y=h-h*e+f.y;f.scale=i;f.refresh();f.x=f.x>0?0:f.x<f.maxScrollX?f.maxScrollX:f.x;f.y=f.y>f.minScrollY?f.minScrollY:f.y<f.maxScrollY?f.maxScrollY:f.y;f.scroller.style[a]=j+"ms";f.scroller.style[J]="translate("+f.x+"px,"+f.y+"px) scale("+i+")"+Q;f.zoomed=false},isReady:function(){return !this.moved&&!this.zoomed&&!this.animating}};function b(e){if(N===""){return e}e=e.charAt(0).toUpperCase()+e.substr(1);return N+e}O=null;if(typeof exports!=="undefined"){module.exports=G}else{Y.iScroll=G}})(window,document);
});